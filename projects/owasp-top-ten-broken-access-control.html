<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>OWASP Top Ten - Broken Access Control | Alec Painter</title>
    <link rel="stylesheet" href="../resources/css/index.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.2/font/bootstrap-icons.css">
</head>

<body>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
        crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script type="text/javascript" src="../resources/js/transition.js" defer></script>

    <style>
        :root {
            --project-colour: rgb(64, 81, 181);
        }
    </style>

    <div class="container-fluid h-100">
        <div class="row h-100 min-vh-100">
            <div class="col-auto px-0 h-100 position-fixed" id="sidebar-col">
                <nav class="navbar sidebar-dark m-0 p-0 h-100" id="sidebar">
                    <div class="container-fluid flex-column align-items-stretch h-100">
                        <div class="row">
                            <a href="../index.html"
                                class="navbar-brand mt-2 mx-0 p-0 d-flex justify-content-center align-items-center h-100 js-trigger-transition">
                                <img src="../resources/images/portfolio-logo-trans.png" alt="Logo" id="sidebar-logo">
                            </a>
                        </div>
                        <div class="row" id="sidebar-nav">
                            <nav class="nav p-0 m-0">
                                <ul class="navbar-nav w-100 text-white text-decoration-none">
                                    <li class="nav-item py-1">
                                        <a href="../index.html"
                                            class="nav-link sidebar-nav-link text-center js-trigger-transition">Home</a>
                                    </li>
                                    <li class="nav-item py-1">
                                        <a href="../projects.html"
                                            class="nav-link sidebar-nav-link text-center js-trigger-transition">Projects</a>
                                    </li>
                                    <li class="nav-item py-1">
                                        <a href="../about.html"
                                            class="nav-link sidebar-nav-link text-center js-trigger-transition">About</a>
                                    </li>
                                    <li class="nav-item py-1">
                                        <a href="../contact.html"
                                            class="nav-link sidebar-nav-link text-center js-trigger-transition">Contact</a>
                                    </li>
                                </ul>
                            </nav>
                        </div>
                        <div class="row" id="sidebar-socials">
                            <ul class="d-flex justify-content-evenly">
                                <a href="https://github.com/alipali737" target="_blank"
                                    class="text-decoration-none px-1 sidebar-social-icon">
                                    <i class="fs-6 bi-github"></i>
                                </a>
                                <a href="mailto:alec.painter@ibm.com" target="_blank"
                                    class="text-decoration-none px-1 sidebar-social-icon">
                                    <i class="fs-6 bi-envelope"></i>
                                </a>
                                <a href="https://www.linkedin.com/in/alec-painter" target="_blank"
                                    class="text-decoration-none px-1 sidebar-social-icon">
                                    <i class="fs-6 bi-linkedin"></i>
                                </a>
                            </ul>
                        </div>
                    </div>
                </nav>
            </div>
            <div class="col" id="main-content-col">
                <div class="row min-vh-100 w-100 my-0">
                    <div class="w-100 mt-4 d-flex flex-column justify-content-start"
                        style="padding-left: 4% !important;">
                        <p class="ps-4 my-3 text-uppercase" style="font-size: 1.2rem; letter-spacing: 3px;"><a
                                href="../projects.html"><i class="bi bi-arrow-left pe-1 text-center"></i>Back to
                                Projects</a></p>
                        <div class="article w-100 m-0" style="border-color: var(--project-colour);">
                            <div class="px-5 w-100">
                                <p class="fs-4 ps-4 my-3" style="letter-spacing: 4px; color: var(--project-colour);">
                                    OWASP TOP TEN</p>
                                <h2 class="text-white">Broken Access Control</h2>
                                <div class="w-100 my-4" style="background-color: white;">
                                    <div class="w-100 my-4"
                                        style="height: 400px; background-image: url('../resources/images/projects/owasp-top-ten/broken-access-control/banner.png'); background-size: contain; background-repeat: no-repeat; background-position: center;">
                                    </div>
                                </div>
                                <div class="my-4">
                                    <p class="m-0 fs-4 fw-bold">Project Contents:</p>
                                    <ol class="project-contents">
                                        <li><a href="#importance-of-access-control">The Importance of Access Control</a>
                                            <ul>
                                                <li><a href="#common-vulns">Common Vulnerabilities in Access Control
                                                        Systems</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#exploiting">Exploiting Broken Access Control</a>
                                            <ul>
                                                <li><a href="#exploiting-force-browsing">Force browsing to access hidden
                                                        pages</a>
                                                    <ul>
                                                        <li><a
                                                                href="#exploiting-force-browsing-mitigations">Mitigations</a>
                                                        </li>
                                                    </ul>
                                                </li>
                                                <li><a href="#exploiting-missing-perms">Missing permission checks on API
                                                        endpoints</a>
                                                    <ul>
                                                        <li><a
                                                                href="#exploiting-missing-perms-mitigations">Mitigations</a>
                                                        </li>
                                                    </ul>
                                                </li>
                                                <li><a href="#exploiting-idor">Insecure Direct Object References</a>
                                                    <ul>
                                                        <li><a href="#exploiting-idor-mitigations">Mitigations</a></li>
                                                    </ul>
                                                </li>
                                            </ul>
                                        </li>
                                    </ol>
                                </div>
                                <hr style="border: 1px solid var(--project-colour); opacity: 1;">
                                <section id="importance-of-access-control">
                                    <h3>The Importance of Access Control</h3>
                                    <p>Broken access control was rated as number 1 in the <a
                                            href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top Ten
                                            2021 list</a>. Access control is a critical element for any modern
                                        application,
                                        ensuring that users cannot engage activities beyond their intended permissions.
                                        Failures in access control can lead to unauthorised information disclosure,
                                        modification, destruction, or performing functions above their intended
                                        limitations.
                                    </p>
                                    <p>Access control in web applications relies on the effective implementation of
                                        three
                                        key aspects: <i>authentication</i>, <i>authorisation</i>, and <i>permission
                                            checks</i>. Broken access control vulnerabilities arise from a failure in
                                        the
                                        implementation of one of these aspects, and are often highly technical
                                        implementations with large attack surfaces.</p>
                                    <section id="common-vulns">
                                        <h4>Common Vulnerabilities in Access Control Systems</h4>
                                        <ul>
                                            <li>Providing too open permissions to all users / not following the least
                                                privilege
                                                principle (deny by default)</li>
                                            <li>Bypassing access control checks by tampering with the internal
                                                application
                                                states or modification of URLs or API requests</li>
                                            <li>Insecure direct object references that allow a user to view or edit a
                                                resource
                                                they shouldn't</li>
                                            <li>Missing access controls on API endpoints and methods</li>
                                            <li>Escalation of privilege</li>
                                            <li>Manipulating application metadata, such as tokens or cookies, to
                                                escalate
                                                privilege</li>
                                            <li>Misconfiguration of CORS to allow API access from unauthorised/untrusted
                                                origins
                                            </li>
                                            <li>Force browsing to access pages the user isn't authorised to access</li>
                                        </ul>
                                    </section>
                                </section>
                                <section id="exploiting">
                                    <h3>Exploiting Broken Access Control</h3>
                                    Broken access control can have many different exploits across a large attack
                                    surface. A
                                    few common examples can be seen below:
                                    <hr>
                                    <ul>
                                        <li>
                                            <section id="exploiting-force-browsing">
                                                <h4>Force browsing to access hidden pages</h4>
                                                <p>Directory enumeration tools combined with common path names could
                                                    lead to
                                                    an
                                                    attacker requesting pages that are intended to be hidden from them.
                                                    This
                                                    exploit could reveal the existence of a page if it returns a 401
                                                    (unauthorised) or if no access control measure is implemented for
                                                    the
                                                    page,
                                                    could allow a user to escalate their privileges.</p>
                                                <section id="exploiting-force-browsing-mitigations">
                                                    <h5>Mitigations</h5>
                                                    <p>By simply implementing authorisation checks on privileged pages a
                                                        developer
                                                        can prevent unauthorised access. In best practice, using an
                                                        authentication
                                                        middleware or single implementation that wraps the entire site
                                                        additionally
                                                        ensures that no page are missed where needed (following a deny
                                                        by
                                                        default
                                                        principle).</p>
                                                </section>
                                            </section>
                                        </li>
                                        <li>
                                            <section id="exploiting-missing-perms">
                                                <h4>Missing permission checks on API endpoints</h4>
                                                <p>A common security flaw in many applications comes from developers not
                                                    considering a user tampering with API requests or creating their
                                                    own.
                                                    Take a
                                                    banking website for example, if there is a transfer endpoint that
                                                    allows
                                                    a
                                                    user to transfer money from their account to another by specifying
                                                    the
                                                    IDs
                                                    of the users. An application could setup a nice front-end that
                                                    limits
                                                    what a
                                                    user can do and automatically populates their ID in the request, but
                                                    without
                                                    access control, a user could modify this request to steal another
                                                    user's
                                                    funds.</p>
                                                <p>An API function could look like this:</p>
                                                <img src="../resources/images/projects/owasp-top-ten/broken-access-control/transfer-function.png"
                                                    alt="example javascript transfer function" class="img-code">
                                                <p>As this function doesn't check that the requesting user is the
                                                    <code>fromUserId</code> this would allow a malicious actor to flip
                                                    the
                                                    IDs
                                                    around, forcing another user to transfer their balance into the
                                                    attacker's.
                                                    <br>
                                                    <br>
                                                    For example:
                                                    <br>
                                                    <code>
                                                        curl -X POST http://bank.com/transfer -H "Content-Type: application/json" -d '{"fromUserId": "victimID","toUserId": "attackerID","amount": 100}'
                                                    </code>
                                                    <br>
                                                    Allowing an attacker to transfer £100 from the balance of their
                                                    victim.
                                                </p>
                                                <section id="exploiting-missing-perms-mitigations">
                                                    <h5>Mitigations</h5>
                                                    <p>This is a relatively simple fix but gains complexity in larger
                                                        projects.
                                                        Ensuring that all 'privileged' API endpoints have authorisation
                                                        checks
                                                        is an
                                                        effective way to prevent this exploitation. Best practices are
                                                        to
                                                        use
                                                        secure
                                                        frameworks or implementations that have a single place for
                                                        checking
                                                        authentication and authorisation such as an API middleware.</p>
                                                </section>
                                            </section>
                                        </li>
                                        <li>
                                            <section id="exploiting-idor">
                                                <h4>Insecure Direct Object References</h4>
                                                <p>A direct object reference is where the page makes a request for a
                                                    data
                                                    object
                                                    of some sort by using a direct reference to it.</p>
                                                <p>For example, this website uses a <code>getUserDetails()</code>
                                                    function
                                                    to
                                                    retrieve the details of a user when a link is pressed. Each link has
                                                    a
                                                    call
                                                    to this function passing the ID of the user:
                                                </p>
                                                <div class="d-flex justify-content-evenly">
                                                    <div style="background-color: white;">
                                                        <img src="/resources/images/projects/owasp-top-ten/broken-access-control/idor-website-links.png"
                                                            alt="demo website with 3 links to show each user's details">
                                                    </div>
                                                    <img class="h-100"
                                                        src="/resources/images/projects/owasp-top-ten/broken-access-control/idor-website-links-html.png"
                                                        alt="example code for the demo website">
                                                </div>
                                                <p>By using simple <i>insecure</i> references (the user ID)
                                                    <code>1</code>,
                                                    <code>2</code>, <code>3</code> an attacker could manipulate the page
                                                    to
                                                    reveal other information, eg. they could logically guess that the
                                                    next
                                                    user
                                                    would be <code>4</code>.
                                                </p>
                                                <p>By running <code>getUserDetails(4)</code> in the console, we can see
                                                    a
                                                    hidden
                                                    <code>admin</code> user appear:
                                                </p>
                                                <img src="/resources/images/projects/owasp-top-ten/broken-access-control/idor-admin.png"
                                                    alt="results of running getUserDetails(4) returns the admin user">
                                                <p>Although this is a simple example, direct object references can be
                                                    incredible
                                                    dangerous and could be used to disclose information or gain access
                                                    to
                                                    user
                                                    information, system files, escalate privileges etc.</p>
                                                <section id="exploiting-idor-mitigations">
                                                    <h5>Mitigations</h5>
                                                    <p>Using complex and secure references can prevent attackers from
                                                        guessing
                                                        references. The use of a translation table can also provide a
                                                        way to
                                                        map
                                                        a
                                                        secure reference to an object reference, the example below
                                                        demonstrates
                                                        mapping files to unique references.</p>
                                                    <table class="table table-dark">
                                                        <thead>
                                                            <tr>
                                                                <th scope="col">Secure Reference</th>
                                                                <th scope="col">Actual Reference</th>
                                                                <th scope="col">URL Example</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr>
                                                                <td scope="row">80d34424-53df-4a97-aa5f-8f00d6290361
                                                                </td>
                                                                <td>/data/company_information.dat</td>
                                                                <td>http://example.com/view?file=80d34424-53df-4a97-aa5f-8f00d6290361
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td scope="row">74031c84-0339-463d-844a-bda003681184
                                                                </td>
                                                                <td>/images/office_map.png</td>
                                                                <td>http://example.com/view?file=74031c84-0339-463d-844a-bda003681184
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td scope="row">d0c458f7-c5ed-44c8-9480-af4e31c00950
                                                                </td>
                                                                <td>/users/ceo_data.json</td>
                                                                <td>http://example.com/view?file=d0c458f7-c5ed-44c8-9480-af4e31c00950
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </section>
                                            </section>
                                        </li>
                                    </ul>
                                </section>
                                <p class="mt-5 text-uppercase" style="letter-spacing: 3px;"><a
                                        href="../projects.html"><i class="bi bi-arrow-left pe-1 text-center"></i>Back to
                                        Projects</a></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

</html>