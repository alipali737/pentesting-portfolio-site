<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Climbing Society Security Assessment | Alec Painter</title>
    <link rel="stylesheet" href="../resources/css/index.css">
    <link rel="stylesheet" href="../resources/css/project-page.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.2/font/bootstrap-icons.css">

</head>

<body>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
        crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script type="text/javascript" src="../resources/js/transition.js" defer></script>

    <style>
        :root {
            --project-colour: rgb(253, 33, 85);
        }
    </style>

    <div class="container-fluid h-100">
        <div class="row h-100 min-vh-100">
            <div class="col-auto px-0 h-100 position-fixed" id="sidebar-col">
                <nav class="navbar sidebar-dark m-0 p-0 h-100" id="sidebar">
                    <div class="container-fluid flex-column align-items-stretch h-100">
                        <div class="row">
                            <a href="../index.html"
                                class="navbar-brand mt-2 mx-0 p-0 d-flex justify-content-center align-items-center h-100 js-trigger-transition">
                                <img src="../resources/images/portfolio-logo-trans.png" alt="Logo" id="sidebar-logo">
                            </a>
                        </div>
                        <div class="row" id="sidebar-nav">
                            <nav class="nav p-0 m-0">
                                <ul class="navbar-nav w-100 text-white text-decoration-none">
                                    <li class="nav-item py-1">
                                        <a href="../index.html"
                                            class="nav-link sidebar-nav-link text-center js-trigger-transition">Home</a>
                                    </li>
                                    <li class="nav-item py-1">
                                        <a href="../projects.html"
                                            class="nav-link sidebar-nav-link text-center js-trigger-transition">Projects</a>
                                    </li>
                                    <li class="nav-item py-1">
                                        <a href="../about.html"
                                            class="nav-link sidebar-nav-link text-center js-trigger-transition">About</a>
                                    </li>
                                    <li class="nav-item py-1">
                                        <a href="../contact.html"
                                            class="nav-link sidebar-nav-link text-center js-trigger-transition">Contact</a>
                                    </li>
                                </ul>
                            </nav>
                        </div>
                        <div class="row" id="sidebar-socials">
                            <ul class="d-flex justify-content-evenly">
                                <a href="https://github.com/alipali737" target="_blank"
                                    class="text-decoration-none px-1 sidebar-social-icon">
                                    <i class="fs-6 bi-github"></i>
                                </a>
                                <a href="mailto:alec.painter@ibm.com" target="_blank"
                                    class="text-decoration-none px-1 sidebar-social-icon">
                                    <i class="fs-6 bi-envelope"></i>
                                </a>
                                <a href="https://www.linkedin.com/in/alec-painter" target="_blank"
                                    class="text-decoration-none px-1 sidebar-social-icon">
                                    <i class="fs-6 bi-linkedin"></i>
                                </a>
                            </ul>
                        </div>
                    </div>
                </nav>
            </div>
            <div class="col" id="main-content-col">
                <div class="row min-vh-100 w-100 my-0">
                    <div class="w-100 mt-4 d-flex flex-column justify-content-start"
                        style="padding-left: 4% !important;">
                        <p class="ps-4 my-3 text-uppercase" style="font-size: 1.2rem; letter-spacing: 3px;"><a
                                href="../projects.html"><i class="bi bi-arrow-left pe-1 text-center"></i>Back to
                                Projects</a></p>
                        <div class="article w-100 m-0" style="border-color: var(--project-colour);">
                            <div class="px-5 w-100">
                                <p class="fs-4 ps-4 my-3" style="letter-spacing: 4px; color: var(--project-colour);">
                                    SECURITY ASSESSMENT</p>
                                <h2 class="text-white">Securing the Climbing Society's Seat Reservation System</h2>
                                <div class="w-100 my-4"
                                    style="height: 400px; background-image: url('../resources/images/projects/climbing-soc-assessment/banner.JPG'); background-size: cover; background-repeat: no-repeat; background-position: center;">
                                </div>
                                <div class="my-4">
                                    <p class="m-0 fs-4 fw-bold">Project Contents:</p>
                                    <ol class="project-contents">
                                        <li><a href="#initiation">Initiation</a></li>
                                        <li><a href="#reconnaissance">Reconnaissance</a></li>
                                        <li><a href="#scanning">Scanning</a></li>
                                        <li><a href="#vulnerability-assessment">Vulnerability Assessment</a></li>
                                    </ol>
                                </div>
                                <hr style="border: 1px solid var(--project-colour); opacity: 1;">

                                <section id="initiation">
                                    <h3>Initiation</h3>
                                    <p>The aim of this project was to conduct a mock security assessment on an
                                        application I
                                        developed for a university society to gain a better understanding of the
                                        security
                                        assessment lifecycle. For this test I will be limiting it to just the
                                        application
                                        without view of the source code. I will be testing each page individually
                                        (including
                                        those behind user authentication).</p>
                                    <p>Although the results of this assessment are likely to not be patched in the
                                        system.
                                        This test will still provide valuable insight into secure coding practices and
                                        application security, alongside knowledge in conducting security assessments.
                                    </p>
                                    <div>
                                </section>
                                <section id="reconnaissance">
                                <h3>Reconnaissance</h3>
                                <p>When first attempting to reach the home page
                                    (<code>http://192.168.68.110:8080/</code>) of the site we are automatically
                                    redirected to an error page:</p>
                                <div class="my-4">
                                    <img class='blog-image'
                                        src="../resources/images/projects/climbing-soc-assessment/error-on-home-url.JPG"
                                        alt="url of error page">
                                    <img class='blog-image'
                                        src="../resources/images/projects/climbing-soc-assessment/error-on-home.JPG"
                                        alt="error caused when accessing the home page">
                                </div>
                                <p>A first observation is that we have been redirected to a <code>/register</code>
                                    directory. The error also seems to be raw from the code itself and is embedded
                                    into the url as a message. Potentially this could be supplied in a link to
                                    manipulate a user, but this is a very low severity issue.</p>
                                <p>If we attempt to query <code>http://192.168.68.110:8080/register</code> using
                                    <i>Burp Suite</i> we can pause the site before the redirect happens to see a new
                                    page appear:
                                </p>
                                <div class="my-4">
                                    <img class="blog-image"
                                        src="../resources/images/projects/climbing-soc-assessment/home-page-preget.JPG"
                                        alt="the register page before the GET request is made">
                                </div>
                                <p>Following the load of this page, a <code>GET</code> request is performed to
                                    <code>/api/event?event=NaN</code>. This is the cause of the error seen earlier.
                                </p>
                                <p>As this is showing as a <code>NaN or Not-A-Number</code> we know this is supposed
                                    to be an integer value. Using the <i>Burp Intruder</i>, we can try iterating
                                    through different values for the event parameter until we get a successful
                                    return.</p>
                                <div class="my-4">
                                    <img class="blog-image"
                                        src="../resources/images/projects/climbing-soc-assessment/intruder-event-number.JPG"
                                        alt="burp intruder iterating through event parameter inputs">
                                </div>
                                <p>Aside from <code>event=0</code>, <code>event=7</code> produces a status code of
                                    200. We can also see that it took significantly longer than any response
                                    suggesting there was some kind of logic or database lookup happening behind the
                                    scenes. Sure enough, we have found our fake pen-test event!</p>
                                <pre>
    <code>
    {
        "event_id":7,
        "session_location":"Pen Test - Event Location",
        "session_date":"23/11/2024",
        "meet_point":"Pen Test - Meet Location",
        "meet_time":"18:15",
        "total_seats":16,
        "current_seats":0,
        "require_member":true,
        "open_date":"19/11/2023 18:00:00",
        "close_date":"22/11/2024 18:00:00",
        "EventStatus":0
    }
</code>
</pre>
                                <p>This provides conclusive evidence that a user may be able to manipulate the URL
                                    params to access events they potentially aren't authorised to view.</p>
                                <p>Continuing to explore the register page, the form could potentially be an entry point
                                    for malicious inputs</p>
                                <div class="my-4">
                                    <img class="blog-image-small"
                                        src="../resources/images/projects/climbing-soc-assessment/register-form.JPG"
                                        alt="the register form for an event">
                                </div>
                                <p>Unfortunately, upon entering a series of special characters <code>'%;<></code> it
                                    appears that the only allowed characters are in the format <code>[A-z]</code> along
                                    with a space between first name and surname.</p>
                            </div>
                        </section>
                            <section id="scanning">

                                <h3>Scanning</h3>
                                <p>After performing a simple directory enumeration using <code>gobuster</code> the only
                                    other page available is <code>/admin</code> area.</p>
                                <div class="my-4">
                                    <img class="blog-image"
                                        src="../resources/images/projects/climbing-soc-assessment/admin-page.JPG"
                                        alt="the admin login page">
                                </div>
                                <p>Aside from brute-force attempts there isn't any apparent ways around this login,
                                    however there is not features to prevent brute-force attempts like timeouts.</p>
                                <p>For the purpose of continuing the test, the correct login details are known. Once
                                    entered a success response is returned along with an encoded JWT token inside a
                                    <code>token</code> cookie. The page then redirects to <code>/admin/dashboard</code>
                                    passing the cookie for authentication. Failure to authenticate returns a 404
                                    response, hiding the page from being discovered in a basic dir enum.
                                </p>
                                <p>The dashboard offers three sections: Add Event, Manage Events, and Manage
                                    Registrations. At the bottom we can see a series of actions available.</p>
                                <div class="my-4">
                                    <img class="blog-image"
                                        src="../resources/images/projects/climbing-soc-assessment/bottom-dashboard.JPG"
                                        alt="the lower half of the admin dashboard page">
                                </div>
                                <p>Testing each of these buttons without specifying a cookie, returns:</p>
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th scope="col">Endpoint</th>
                                            <th scope="col">Method</th>
                                            <th scope="col">Response</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>/api/events</td>
                                            <td>POST</td>
                                            <td>404</td>
                                        </tr>
                                        <tr>
                                            <td>/api/events</td>
                                            <td>GET</td>
                                            <td>404</td>
                                        </tr>
                                        <tr>
                                            <td>/api/participants</td>
                                            <td>GET</td>
                                            <td>400</td>
                                        </tr>
                                        <tr>
                                            <td>/api/participants?event=7</td>
                                            <td>GET</td>
                                            <td>404</td>
                                        </tr>
                                    </tbody>
                                </table>
                                <p>It does appear that all the available end points that are supported require a valid
                                    authentication token meaning that an attacker couldn't make remote requests to control
                                    the system without proper authorisation.</p>
                            </section>
                            <section id="vulnerability-assessment">

                                <h3>Vulnerability Assessment</h3>
                                <p>From the investigations earlier, a list of possible vulnerabilities have been identified.
                                    They have each been ranked using their calculated CVSS score.</p>
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th scope="col">CVSS</th>
                                            <th scope="col">Severity</th>
                                            <th scope="col">Title</th>
                                            <th scope="col">Description</th>
                                            <th scope="col">Impact</th>
                                            <th scope="col">Remediation</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <th scope="row">7.1</th>
                                            <td class="cvss-high">High</td>
                                            <td>Brute force admin login credentials</td>
                                            <td>An attacker could brute force the admin login credentials to gain access to
                                                the admin dashboard.</td>
                                            <td>The attacker would gain full access to the dashboard, and control over any
                                                events.</td>
                                            <td>
                                                <ul>
                                                    <li>Require admins to use strong passwords</li>
                                                    <li>Limit login attempts and add a timeout</li>
                                                    <li>Implement a two-factor authentication</li>
                                                </ul>
                                            </td>
                                        </tr>
                                        <tr>
                                            <th scope="row">5.6</th>
                                            <td class="cvss-medium">Medium</td>
                                            <td>Insecure Direct Object Reference for Events in URL params</td>
                                            <td>Events are indexed by sequential integers and can be manipulated in the URL
                                            </td>
                                            <td>An attacker could gain access to register for an event before its available
                                                to them</td>
                                            <td>
                                                <ul>
                                                    <li>Index events by a UUID instead</li>
                                                </ul>
                                            </td>
                                        </tr>
                                        <tr>
                                            <th scope="row">4.1</th>
                                            <td class="cvss-medium">Medium</td>
                                            <td>Create false error page links</td>
                                            <td>As error messages are stored in the link itself, an attacker to mis-inform a
                                                user by crafting a link with a custom message</td>
                                            <td>A user could be mis-informed as part of a larger social engineering attack
                                            </td>
                                            <td>
                                                <ul>
                                                    <li>Pass the error message in the response body or a custom header
                                                        instead of through the URL</li>
                                                    <li>Store the error message server-side and associate it with a session
                                                        cookie that the user can request the error using</li>
                                                    <li>Have static pages for each error instead of having a dynamic page
                                                    </li>
                                                </ul>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </section>
                            <p class="mt-5 text-uppercase" style="letter-spacing: 3px;"><a href="../projects.html"><i
                                        class="bi bi-arrow-left pe-1 text-center"></i>Back to
                                    Projects</a></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>
</body>

</html>